<!doctype html>
<head>
  <base href="/test/fixtures/es-modules/">
</head>
<link rel="stylesheet" type="text/css" href="../../../node_modules/mocha/mocha.css"/>
<script src="../../../node_modules/mocha/mocha.js"></script>
<script type="importmap-shim">
{
  "imports": {
    "base-href-bare": "./base-href-bare.js"
  }
}
</script>
<!--<script type="module" src="../../../../src/es-module-shims.js"></script>-->
<script type="module">
  import { importWithMap } from '../../../../src/es-module-shims.js';
  console.log(importWithMap);

  const importMap = {
    imports: {
      "react": "https://esm.sh/react@18.2.0?dev",
      "react-dom": "https://esm.sh/react-dom@18.2.0?dev",
      "react-dom/client": "https://esm.sh/react-dom@18.2.0/client?dev",
      "prop-types": "https://esm.sh/prop-types@15.8.1?dev",
      "react-feather": "https://unpkg.com/react-feather@2.0.10/dist/index.js"
    }
  };

  const React = await importWithMap("react", importMap);
  const { createRoot } = await importWithMap("react-dom/client", importMap);
  const { Smile } = await importWithMap('react-feather', importMap);

  function MyApp(props) {
    return React.createElement(React.Suspense,
      { fallback: React.createElement('div', {}, 'Loading...') },
      React.createElement(Smile),
    );
  }

  const domContainer = document.getElementById('root');
  const root = createRoot(domContainer);
  root.render(React.createElement(MyApp));
</script>

<div id="root"></div>
